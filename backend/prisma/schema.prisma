generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id        String   @id @default(uuid())
  email     String   @unique
  password  String?
  name      String?
  role      String   @default("user") // "user", "admin"
  createdAt DateTime @default(now())

  prayerSettings PrayerSettings?
  favorites      Favorite[]
  readingHistory ReadingHistory[]
  adhanSetting   AdhanSetting?

  @@map("users")
}

model PrayerSettings {
  userId            String @id
  calculationMethod String?
  madhab            String?
  latitude          Float?
  longitude         Float?

  user User @relation(fields: [userId], references: [id])

  @@map("prayer_settings")
}

model Favorite {
  id          String   @id @default(uuid())
  userId      String
  surahNumber Int
  ayahNumber  Int
  createdAt   DateTime @default(now())

  user User @relation(fields: [userId], references: [id])

  @@map("favorites")
}

model ReadingHistory {
  id          String   @id @default(uuid())
  userId      String
  surahNumber Int
  ayahNumber  Int
  lastReadAt  DateTime @default(now())

  user User @relation(fields: [userId], references: [id])

  @@map("reading_history")
}

model DonationMethod {
  id          String   @id @default(uuid())
  name        String
  description String?
  identifier  String
  type        String   // "link", "copy", "phone"
  icon        String?
  isActive    Boolean  @default(true)
  createdAt   DateTime @default(now())

  @@map("donation_methods")
}

model AdhanSetting {
  userId       String @id
  defaultAdhan String @default("makkah")
  fajrAdhan    String?
  dhuhrAdhan   String?
  asrAdhan     String?
  maghribAdhan String?
  ishaAdhan    String?
  
  user User @relation(fields: [userId], references: [id])

  @@map("adhan_settings")
}

model AppVersion {
  id          String   @id @default(uuid())
  version     String   @unique
  buildNumber Int
  forceUpdate Boolean  @default(false)
  description String?
  createdAt   DateTime @default(now())
  
  @@map("app_versions")
}

model GlobalSetting {
  key         String   @id
  value       String
  description String?
  updatedAt   DateTime @updatedAt
  
  @@map("global_settings")
}
